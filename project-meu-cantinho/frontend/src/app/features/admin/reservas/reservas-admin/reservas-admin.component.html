<div class="reservas-container">
  <div class="reservas-header">
    <h1>ğŸ“… Gerenciamento de Reservas</h1>
    <p>Controle completo de reservas e pagamentos de todas as filiais</p>
  </div>

  <!-- EstatÃ­sticas -->
  <div class="stats-grid">
    <div class="stat-card">
      <div class="stat-icon">ğŸ“‹</div>
      <div class="stat-content">
        <div class="stat-value">{{ getTotalReservas() }}</div>
        <div class="stat-label">Total de Reservas</div>
      </div>
    </div>
    <div class="stat-card">
      <div class="stat-icon">ğŸ’°</div>
      <div class="stat-content">
        <div class="stat-value">R$ {{ getValorTotalReservas() | number:'1.2-2' }}</div>
        <div class="stat-label">Valor Total</div>
      </div>
    </div>
    <div class="stat-card">
      <div class="stat-icon">ğŸ’³</div>
      <div class="stat-content">
        <div class="stat-value">R$ {{ getValorTotalPago() | number:'1.2-2' }}</div>
        <div class="stat-label">Total Pago</div>
      </div>
    </div>
    <div class="stat-card">
      <div class="stat-icon">âš ï¸</div>
      <div class="stat-content">
        <div class="stat-value">R$ {{ getSaldoPendente() | number:'1.2-2' }}</div>
        <div class="stat-label">Saldo Pendente</div>
      </div>
    </div>
  </div>

  <!-- Filtros -->
  <div class="filters-section">
    <div class="filter-group">
      <label>ğŸ” Buscar</label>
      <input
        type="text"
        class="search-input"
        placeholder="Buscar por cliente ou espaÃ§o..."
        [(ngModel)]="searchTerm"
        (input)="onSearchChange(searchTerm)"
      />
    </div>

    <div class="filter-group">
      <label>ğŸ“Š Status</label>
      <select
        class="filter-select"
        [(ngModel)]="statusFilter"
        (change)="onStatusFilterChange(statusFilter)"
      >
        <option value="TODOS">Todos</option>
        <option [value]="StatusReserva.AGUARDANDO_SINAL">Aguardando Sinal</option>
        <option [value]="StatusReserva.CONFIRMADA">Confirmada</option>
        <option [value]="StatusReserva.QUITADA">Quitada</option>
        <option [value]="StatusReserva.FINALIZADA">Finalizada</option>
        <option [value]="StatusReserva.CANCELADA">Cancelada</option>
      </select>
    </div>

    <div class="filter-group">
      <label>ğŸ“… PerÃ­odo</label>
      <select
        class="filter-select"
        [(ngModel)]="dataFilter"
        (change)="onDataFilterChange(dataFilter)"
      >
        <option value="FUTURAS">Futuras</option>
        <option value="PASSADAS">Passadas</option>
        <option value="TODAS">Todas</option>
      </select>
    </div>

    <div class="filter-group">
      <label>ğŸ’³ Pagamento</label>
      <select
        class="filter-select"
        [(ngModel)]="pagamentoFilter"
        (change)="onPagamentoFilterChange(pagamentoFilter)"
      >
        <option value="TODOS">Todos</option>
        <option value="QUITADA">Quitadas</option>
        <option value="PENDENTE">Pendentes</option>
      </select>
    </div>
  </div>

  <app-loading *ngIf="loading"></app-loading>

  <div *ngIf="error" class="alert alert-danger">
    {{ error }}
  </div>

  <!-- Lista de Reservas -->
  <div *ngIf="!loading && reservasFiltradas.length === 0" class="empty-state">
    <span class="empty-icon">ğŸ“­</span>
    <h3>Nenhuma reserva encontrada</h3>
    <p>NÃ£o hÃ¡ reservas que correspondam aos filtros aplicados</p>
  </div>

  <div *ngIf="!loading && reservasFiltradas.length > 0" class="reservas-grid">
    <div *ngFor="let reserva of reservasFiltradas" class="reserva-card" [ngClass]="getStatusClass(reserva.status)">
      <div class="reserva-header">
        <div class="reserva-title">
          <span class="status-icon">{{ getStatusIcon(reserva.status) }}</span>
          <span class="status-text">{{ reserva.status }}</span>
        </div>
        <span class="reserva-id">#{{ reserva.id }}</span>
      </div>

      <div class="reserva-body">
        <!-- InformaÃ§Ãµes do Cliente -->
        <div class="info-section">
          <div class="section-title">ğŸ‘¤ Cliente</div>
          <div class="info-value">{{ reserva.usuario.nome || 'N/A' }}</div>
        </div>

        <!-- InformaÃ§Ãµes do EspaÃ§o -->
        <div class="info-section">
          <div class="section-title">ğŸ›ï¸ EspaÃ§o</div>
          <div class="info-value">{{ reserva.espaco.nome || 'N/A' }}</div>
        </div>

        <!-- Data do Evento -->
        <div class="info-section">
          <div class="section-title">ğŸ“… Data do Evento</div>
          <div class="info-value" [ngClass]="getDataClass(reserva.dataEvento)">
            {{ reserva.dataEvento | date: 'dd/MM/yyyy' }}
          </div>
        </div>

        <!-- InformaÃ§Ãµes Financeiras -->
        <div class="financial-section">
          <div class="financial-row">
            <span class="financial-label">ğŸ’° Valor Total:</span>
            <span class="financial-value">R$ {{ reserva.valorTotal | number:'1.2-2' }}</span>
          </div>
          <div class="financial-row" *ngIf="reserva.totalPago !== undefined">
            <span class="financial-label">ğŸ’³ Valor Pago:</span>
            <span class="financial-value">R$ {{ reserva.totalPago | number:'1.2-2' }}</span>
          </div>
          <div class="financial-row" *ngIf="reserva.saldo !== undefined && reserva.saldo > 0">
            <span class="financial-label saldo-label">âš ï¸ Saldo:</span>
            <span class="financial-value saldo-value">R$ {{ reserva.saldo | number:'1.2-2' }}</span>
          </div>
        </div>

        <!-- Status de Pagamento -->
        <div class="pagamento-badge" [ngClass]="getPagamentoClass(reserva)">
          {{ getPagamentoStatus(reserva) }}
        </div>
      </div>

      <!-- AÃ§Ãµes -->
      <div class="reserva-actions">
        <div class="status-actions" *ngIf="reserva.status !== StatusReserva.CANCELADA && reserva.status !== StatusReserva.FINALIZADA">
          <app-button
            *ngIf="reserva.status === StatusReserva.AGUARDANDO_SINAL"
            variant="success"
            size="small"
            icon="âœ…"
            (clicked)="updateStatus(reserva, StatusReserva.CONFIRMADA)"
          >
            Confirmar
          </app-button>

          <app-button
            *ngIf="reserva.status === StatusReserva.CONFIRMADA"
            variant="primary"
            size="small"
            icon="ğŸ’°"
            (clicked)="updateStatus(reserva, StatusReserva.QUITADA)"
          >
            Quitar
          </app-button>

          <app-button
            *ngIf="reserva.status === StatusReserva.QUITADA"
            variant="success"
            size="small"
            icon="ğŸ‰"
            (clicked)="updateStatus(reserva, StatusReserva.FINALIZADA)"
          >
            Finalizar
          </app-button>

          <app-button
            variant="danger"
            size="small"
            icon="âŒ"
            (clicked)="updateStatus(reserva, StatusReserva.CANCELADA)"
          >
            Cancelar
          </app-button>
        </div>
      </div>
    </div>
  </div>
</div>
