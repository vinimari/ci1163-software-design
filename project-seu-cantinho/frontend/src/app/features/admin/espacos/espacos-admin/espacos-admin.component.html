<div class="admin-container">
  @if (!showForm) {
    <div class="header">
      <div class="title-section">
        <h1>üèõÔ∏è Gest√£o de Espa√ßos</h1>
        <p>Gerencie os espa√ßos dispon√≠veis para aluguel</p>
      </div>
      <app-button variant="primary" icon="‚ûï" (clicked)="novoEspaco()">
        Novo Espa√ßo
      </app-button>
    </div>

    <div class="filters">
      <div class="search-box">
        <span class="search-icon">üîç</span>
        <input
          type="text"
          placeholder="Buscar por nome ou filial..."
          (input)="onSearchChange($any($event.target).value)"
          [value]="searchTerm"
        />
      </div>

      <div class="filter-group">
        <label>Status:</label>
        <select (change)="onStatusFilterChange($any($event.target).value)" [value]="filtroStatus">
          <option value="">Todos</option>
          <option value="ativo">Ativos</option>
          <option value="inativo">Inativos</option>
        </select>
      </div>
    </div>

    @if (loading) {
      <div class="loading-container">
        <div class="spinner-large"></div>
        <p>Carregando espa√ßos...</p>
      </div>
    } @else {
      @if (espacosFiltrados.length === 0) {
        <div class="empty-state">
          <span class="empty-icon">üì≠</span>
          <h3>Nenhum espa√ßo encontrado</h3>
          <p>{{ searchTerm ? 'Tente ajustar os filtros de busca' : 'Comece criando um novo espa√ßo' }}</p>
          @if (!searchTerm) {
            <app-button variant="primary" (clicked)="novoEspaco()">Criar Primeiro Espa√ßo</app-button>
          }
        </div>
      } @else {
        <div class="espacos-grid">
          @for (espaco of espacosFiltrados; track espaco.id) {
            <div class="espaco-card" [class.inactive]="!espaco.ativo">
              @if (espaco.urlFotoPrincipal) {
                <div class="card-image">
                  <img [src]="espaco.urlFotoPrincipal" [alt]="espaco.nome" />
                  @if (!espaco.ativo) {
                    <div class="inactive-badge">Inativo</div>
                  }
                </div>
              } @else {
                <div class="card-image placeholder">
                  <span class="placeholder-icon">üèõÔ∏è</span>
                  @if (!espaco.ativo) {
                    <div class="inactive-badge">Inativo</div>
                  }
                </div>
              }

              <div class="card-content">
                <h3>{{ espaco.nome }}</h3>

                @if (espaco.descricao) {
                  <p class="description">{{ espaco.descricao }}</p>
                }

                <div class="info-grid">
                  <div class="info-item">
                    <span class="icon">üìç</span>
                    <span>{{ espaco.filial.nome }}</span>
                  </div>
                  <div class="info-item">
                    <span class="icon">üë•</span>
                    <span>{{ espaco.capacidade }} pessoas</span>
                  </div>
                  <div class="info-item">
                    <span class="icon">üí∞</span>
                    <span>R$ {{ espaco.precoDiaria | number:'1.2-2' }}</span>
                  </div>
                  <div class="info-item">
                    <span class="icon">{{ espaco.ativo ? '‚úÖ' : '‚ùå' }}</span>
                    <span>{{ espaco.ativo ? 'Ativo' : 'Inativo' }}</span>
                  </div>
                </div>

                <div class="card-actions">
                  <app-button variant="success" size="small" icon="‚úèÔ∏è" (clicked)="editarEspaco(espaco)">
                    Editar
                  </app-button>
                  <app-button
                    variant="warning"
                    size="small"
                    [icon]="espaco.ativo ? 'üîí' : 'üîì'"
                    (clicked)="toggleAtivo(espaco)"
                  >
                    {{ espaco.ativo ? 'Desativar' : 'Ativar' }}
                  </app-button>
                  <app-button variant="danger" size="small" icon="üóëÔ∏è" (clicked)="excluirEspaco(espaco)">
                    Excluir
                  </app-button>
                </div>
              </div>
            </div>
          }
        </div>
      }
    }
  } @else {
    <app-espaco-form
      [espaco]="espacoSelecionado"
      [filialIdFuncionario]="filialIdFuncionario"
      (submitForm)="onSubmitForm($event)"
      (cancel)="onCancelForm()"
    />
  }
</div>
