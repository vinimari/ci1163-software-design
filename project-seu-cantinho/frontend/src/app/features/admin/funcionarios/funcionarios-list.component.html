<div class="funcionarios-container">
  <div class="header">
    <h1>Gerenciar Funcionários</h1>
    <button class="btn btn-primary" routerLink="/admin/funcionarios/new">
      + Novo Funcionário
    </button>
  </div>

  <div class="filters">
    <div class="filter-group">
      <label for="filial-filter">Filtrar por Filial:</label>
      <select
        id="filial-filter"
        [(ngModel)]="selectedFilialId"
        (change)="onFilialFilterChange()"
        class="form-select">
        <option [ngValue]="null">Todas as filiais</option>
        <option *ngFor="let filial of filiais" [ngValue]="filial.id">
          {{ filial.nome }}
        </option>
      </select>
      <button *ngIf="selectedFilialId" class="btn btn-secondary" (click)="clearFilter()">
        Limpar Filtro
      </button>
    </div>
  </div>

  <app-loading *ngIf="loading"></app-loading>

  <div *ngIf="error" class="error-message">
    {{ error }}
  </div>

  <div *ngIf="!loading && !error" class="table-container">
    <table class="funcionarios-table">
      <thead>
        <tr>
          <th>Matrícula</th>
          <th>Nome</th>
          <th>Email</th>
          <th>Filial</th>
          <th>Status</th>
          <th>Ações</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let funcionario of funcionarios">
          <td>{{ funcionario.matricula }}</td>
          <td>{{ funcionario.nome }}</td>
          <td>{{ funcionario.email }}</td>
          <td>{{ funcionario.filial.nome }}</td>
          <td>
            <span [class]="getStatusClass(funcionario.ativo)">
              {{ getStatusText(funcionario.ativo) }}
            </span>
          </td>
          <td class="actions">
            <button
              class="btn btn-sm btn-info"
              (click)="editFuncionario(funcionario.id)"
              title="Editar">
              Editar
            </button>
            <button
              class="btn btn-sm btn-warning"
              (click)="toggleAtivo(funcionario)"
              title="{{ funcionario.ativo ? 'Desativar' : 'Ativar' }}">
              {{ funcionario.ativo ? 'Desativar' : 'Ativar' }}
            </button>
            <button
              class="btn btn-sm btn-danger"
              (click)="deleteFuncionario(funcionario)"
              title="Excluir">
              Excluir
            </button>
          </td>
        </tr>
        <tr *ngIf="funcionarios.length === 0">
          <td colspan="6" class="no-data">
            Nenhum funcionário encontrado
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
