graph TB
    subgraph External["ğŸŒ CAMADA EXTERNA"]
        Browser[Browser/Cliente HTTP]
        AngularApp[Angular SPA]
        NginxProxy[NGINX]
    end

    subgraph Infrastructure["ğŸ”§ INFRAESTRUTURA"]
        direction LR
        SpringSecurity[Spring Security + JWT]
        SwaggerUI[Swagger/OpenAPI]
        ExceptionHandler[Exception Handler]
    end

    subgraph Auth["ğŸ” AUTENTICAÃ‡ÃƒO"]
        direction TB
        AuthController["ğŸ”Œ Adapter IN<br/>AuthController<br/>/api/auth"]
        AuthWebPort["ğŸ“¥ Port IN<br/>AuthWebPort"]
        AuthService["ğŸ“¥ Port IN<br/>AuthService<br/>AuthServicePort"]
        AuthDomain["ğŸ¯ Domain<br/>Usuario Entity<br/>id, email, senha, perfil"]
        AuthRepoPort["ğŸ“¤ Port OUT<br/>UsuarioRepositoryPort"]
        AuthPassPort["ğŸ“¤ Port OUT<br/>PasswordEncoderPort"]
        AuthRepoAdapter["ğŸ”§ Adapter OUT<br/>UsuarioRepositoryAdapter"]
        AuthPassAdapter["ğŸ”§ Adapter OUT<br/>PasswordEncoderAdapter"]
        AuthJPA["ğŸ’¾ JPA Repository<br/>UsuarioRepository"]

        AuthController -.->|implements| AuthWebPort
        AuthController -->|calls| AuthService
        AuthService -->|uses| AuthDomain
        AuthService -->|depends on| AuthRepoPort
        AuthService -->|depends on| AuthPassPort
        AuthRepoPort <-.->|implemented by| AuthRepoAdapter
        AuthPassPort <-.->|implemented by| AuthPassAdapter
        AuthRepoAdapter -->|uses| AuthJPA
    end

    subgraph Cliente["ğŸ‘¤ CLIENTE"]
        direction TB
        ClienteController["ğŸ”Œ Adapter IN<br/>ClienteController<br/>/api/clientes"]
        ClienteWebPort["ğŸ“¥ Port IN<br/>ClienteWebPort"]
        ClienteService["ğŸ“¥ Port IN<br/>ClienteService<br/>ClienteServicePort"]
        ClienteDomain["ğŸ¯ Domain<br/>Cliente Entity<br/>extends Usuario"]
        ClienteRepoPort["ğŸ“¤ Port OUT<br/>ClienteRepositoryPort"]
        ClienteRepoAdapter["ğŸ”§ Adapter OUT<br/>ClienteRepositoryAdapter<br/>ClienteMapper"]
        ClienteJPA["ğŸ’¾ JPA Repository<br/>ClienteRepository"]

        ClienteController -.->|implements| ClienteWebPort
        ClienteController -->|calls| ClienteService
        ClienteService -->|uses| ClienteDomain
        ClienteService -->|depends on| ClienteRepoPort
        ClienteRepoPort <-.->|implemented by| ClienteRepoAdapter
        ClienteRepoAdapter -->|uses| ClienteJPA
    end

    subgraph Funcionario["ğŸ‘” FUNCIONÃRIO"]
        direction TB
        FuncController["ğŸ”Œ Adapter IN<br/>FuncionarioController<br/>/api/funcionarios"]
        FuncService["ğŸ“¥ Port IN<br/>FuncionarioService"]
        FuncDomain["ğŸ¯ Domain<br/>Funcionario Entity<br/>extends Usuario"]
        FuncRepoPort["ğŸ“¤ Port OUT<br/>UsuarioRepositoryPort"]
        FuncRepoAdapter["ğŸ”§ Adapter OUT<br/>UsuarioRepositoryAdapter"]
        FuncJPA["ğŸ’¾ JPA Repository<br/>UsuarioRepository"]

        FuncController -->|calls| FuncService
        FuncService -->|uses| FuncDomain
        FuncService -->|depends on| FuncRepoPort
        FuncRepoPort <-.->|implemented by| FuncRepoAdapter
        FuncRepoAdapter -->|uses| FuncJPA
    end

    subgraph Admin["âš™ï¸ ADMINISTRADOR"]
        direction TB
        AdminController["ğŸ”Œ Adapter IN<br/>AdministradorController<br/>/api/administradores"]
        AdminService["ğŸ“¥ Port IN<br/>AdministradorService"]
        AdminDomain["ğŸ¯ Domain<br/>Administrador Entity<br/>extends Usuario"]
        AdminRepoPort["ğŸ“¤ Port OUT<br/>UsuarioRepositoryPort"]
        AdminRepoAdapter["ğŸ”§ Adapter OUT<br/>UsuarioRepositoryAdapter"]
        AdminJPA["ğŸ’¾ JPA Repository<br/>UsuarioRepository"]

        AdminController -->|calls| AdminService
        AdminService -->|uses| AdminDomain
        AdminService -->|depends on| AdminRepoPort
        AdminRepoPort <-.->|implemented by| AdminRepoAdapter
        AdminRepoAdapter -->|uses| AdminJPA
    end

    subgraph Filial["ğŸ¢ FILIAL"]
        direction TB
        FilialController["ğŸ”Œ Adapter IN<br/>FilialController<br/>/api/filiais"]
        FilialWebPort["ğŸ“¥ Port IN<br/>FilialWebPort"]
        FilialService["ğŸ“¥ Port IN<br/>FilialService<br/>FilialServicePort"]
        FilialDomain["ğŸ¯ Domain<br/>Filial Entity<br/>id, nome, endereco"]
        FilialRepoPort["ğŸ“¤ Port OUT<br/>FilialRepositoryPort"]
        FilialRepoAdapter["ğŸ”§ Adapter OUT<br/>FilialRepositoryAdapter<br/>FilialMapper"]
        FilialJPA["ğŸ’¾ JPA Repository<br/>FilialRepository"]

        FilialController -.->|implements| FilialWebPort
        FilialController -->|calls| FilialService
        FilialService -->|uses| FilialDomain
        FilialService -->|depends on| FilialRepoPort
        FilialRepoPort <-.->|implemented by| FilialRepoAdapter
        FilialRepoAdapter -->|uses| FilialJPA
    end

    subgraph Espaco["ğŸ  ESPAÃ‡O"]
        direction TB
        EspacoController["ğŸ”Œ Adapter IN<br/>EspacoController<br/>/api/espacos"]
        EspacoWebPort["ğŸ“¥ Port IN<br/>EspacoWebPort"]
        EspacoService["ğŸ“¥ Port IN<br/>EspacoService<br/>EspacoServicePort"]
        EspacoDomain["ğŸ¯ Domain<br/>Espaco Entity<br/>Capacidade VO<br/>ValorMonetario VO"]
        EspacoRepoPort["ğŸ“¤ Port OUT<br/>EspacoRepositoryPort"]
        EspacoRepoAdapter["ğŸ”§ Adapter OUT<br/>EspacoRepositoryAdapter<br/>EspacoMapper"]
        EspacoJPA["ğŸ’¾ JPA Repository<br/>EspacoRepository"]

        EspacoController -.->|implements| EspacoWebPort
        EspacoController -->|calls| EspacoService
        EspacoService -->|uses| EspacoDomain
        EspacoService -->|depends on| EspacoRepoPort
        EspacoRepoPort <-.->|implemented by| EspacoRepoAdapter
        EspacoRepoAdapter -->|uses| EspacoJPA
    end

    subgraph Reserva["ğŸ“… RESERVA"]
        direction TB
        ReservaController["ğŸ”Œ Adapter IN<br/>ReservaController<br/>/api/reservas"]
        ReservaWebPort["ğŸ“¥ Port IN<br/>ReservaWebPort"]
        ReservaService["ğŸ“¥ Port IN<br/>ReservaService<br/>ReservaServicePort"]
        ReservaDomain["ğŸ¯ Domain<br/>Reserva (Aggregate)<br/>DataEvento VO<br/>Domain Services"]
        ReservaRepoPort["ğŸ“¤ Port OUT<br/>ReservaRepositoryPort"]
        ReservaRepoAdapter["ğŸ”§ Adapter OUT<br/>ReservaRepositoryAdapter<br/>ReservaMapper"]
        ReservaJPA["ğŸ’¾ JPA Repository<br/>ReservaRepository"]

        ReservaController -.->|implements| ReservaWebPort
        ReservaController -->|calls| ReservaService
        ReservaService -->|uses| ReservaDomain
        ReservaService -->|depends on| ReservaRepoPort
        ReservaRepoPort <-.->|implemented by| ReservaRepoAdapter
        ReservaRepoAdapter -->|uses| ReservaJPA
    end

    subgraph Pagamento["ğŸ’³ PAGAMENTO"]
        direction TB
        PagamentoController["ğŸ”Œ Adapter IN<br/>PagamentoController<br/>/api/pagamentos"]
        PagamentoWebPort["ğŸ“¥ Port IN<br/>PagamentoWebPort"]
        PagamentoService["ğŸ“¥ Port IN<br/>PagamentoService<br/>PagamentoServicePort"]
        PagamentoDomain["ğŸ¯ Domain<br/>Pagamento Entity<br/>ValorMonetario VO<br/>Strategy Pattern"]
        PagamentoRepoPort["ğŸ“¤ Port OUT<br/>PagamentoRepositoryPort"]
        PagamentoRepoAdapter["ğŸ”§ Adapter OUT<br/>PagamentoRepositoryAdapter<br/>PagamentoMapper"]
        PagamentoJPA["ğŸ’¾ JPA Repository<br/>PagamentoRepository"]

        PagamentoController -.->|implements| PagamentoWebPort
        PagamentoController -->|calls| PagamentoService
        PagamentoService -->|uses| PagamentoDomain
        PagamentoService -->|depends on| PagamentoRepoPort
        PagamentoRepoPort <-.->|implemented by| PagamentoRepoAdapter
        PagamentoRepoAdapter -->|uses| PagamentoJPA
    end

    PostgreSQL[(ğŸ—„ï¸ PostgreSQL<br/>Port 5433)]

    %% ConexÃµes Externas
    Browser -->|HTTPS| NginxProxy
    AngularApp -->|HTTP| NginxProxy
    NginxProxy -->|forwards to| Infrastructure

    %% Infraestrutura para Features
    Infrastructure -->|routes to| AuthController
    Infrastructure -->|routes to| ClienteController
    Infrastructure -->|routes to| FuncController
    Infrastructure -->|routes to| AdminController
    Infrastructure -->|routes to| FilialController
    Infrastructure -->|routes to| EspacoController
    Infrastructure -->|routes to| ReservaController
    Infrastructure -->|routes to| PagamentoController

    %% PersistÃªncia
    AuthJPA -->|persists to| PostgreSQL
    ClienteJPA -->|persists to| PostgreSQL
    FuncJPA -->|persists to| PostgreSQL
    AdminJPA -->|persists to| PostgreSQL
    FilialJPA -->|persists to| PostgreSQL
    EspacoJPA -->|persists to| PostgreSQL
    ReservaJPA -->|persists to| PostgreSQL
    PagamentoJPA -->|persists to| PostgreSQL
