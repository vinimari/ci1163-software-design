<div class="form-container">
  <div class="form-header">
    <h2>{{ isEditMode ? 'âœï¸ Editar Filial' : 'â• Nova Filial' }}</h2>
  </div>

  <app-loading *ngIf="loading"></app-loading>

  <div *ngIf="error" class="alert alert-danger">
    {{ error }}
  </div>

  <form [formGroup]="filialForm" (ngSubmit)="onSubmit()" *ngIf="!loading">
    <div class="form-group">
      <label for="nome">ğŸ¢ Nome da Filial *</label>
      <input
        type="text"
        id="nome"
        formControlName="nome"
        [class.is-invalid]="nome?.invalid && nome?.touched"
        placeholder="Ex: Filial Centro"
      />
      <div class="invalid-feedback" *ngIf="nome?.invalid && nome?.touched">
        <span *ngIf="nome?.errors?.['required']">Nome Ã© obrigatÃ³rio</span>
        <span *ngIf="nome?.errors?.['minlength']">Nome deve ter no mÃ­nimo 3 caracteres</span>
      </div>
    </div>

    <div class="form-row">
      <div class="form-group">
        <label for="cidade">ğŸ“ Cidade *</label>
        <input
          type="text"
          id="cidade"
          formControlName="cidade"
          [class.is-invalid]="cidade?.invalid && cidade?.touched"
          placeholder="Ex: SÃ£o Paulo"
        />
        <div class="invalid-feedback" *ngIf="cidade?.invalid && cidade?.touched">
          <span *ngIf="cidade?.errors?.['required']">Cidade Ã© obrigatÃ³ria</span>
          <span *ngIf="cidade?.errors?.['minlength']">Cidade deve ter no mÃ­nimo 2 caracteres</span>
        </div>
      </div>

      <div class="form-group">
        <label for="estado">ğŸ—ºï¸ Estado (UF) *</label>
        <input
          type="text"
          id="estado"
          formControlName="estado"
          maxlength="2"
          [class.is-invalid]="estado?.invalid && estado?.touched"
          placeholder="Ex: SP"
          style="text-transform: uppercase;"
        />
        <div class="invalid-feedback" *ngIf="estado?.invalid && estado?.touched">
          <span *ngIf="estado?.errors?.['required']">Estado Ã© obrigatÃ³rio</span>
          <span *ngIf="estado?.errors?.['minlength'] || estado?.errors?.['maxlength']">
            Estado deve ter 2 caracteres
          </span>
        </div>
      </div>
    </div>

    <div class="form-group">
      <label for="endereco">ğŸ  EndereÃ§o</label>
      <input
        type="text"
        id="endereco"
        formControlName="endereco"
        placeholder="Rua, nÃºmero, complemento"
      />
    </div>

    <div class="form-group">
      <label for="telefone">ğŸ“ Telefone</label>
      <input
        type="text"
        id="telefone"
        formControlName="telefone"
        [class.is-invalid]="telefone?.invalid && telefone?.touched"
        placeholder="(99) 99999-9999"
      />
      <div class="invalid-feedback" *ngIf="telefone?.invalid && telefone?.touched">
        <span *ngIf="telefone?.errors?.['pattern']">
          Telefone deve estar no formato (99) 99999-9999
        </span>
      </div>
    </div>

    <div class="form-actions">
      <app-button type="button" variant="secondary" (clicked)="cancel()" [disabled]="loading">
        Cancelar
      </app-button>
      <app-button type="submit" variant="primary" [disabled]="loading || filialForm.invalid" [icon]="isEditMode ? 'ğŸ’¾' : 'â•'">
        {{ isEditMode ? 'Atualizar' : 'Criar' }}
      </app-button>
    </div>
  </form>
</div>
